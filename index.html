<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cidade de Fortini - Vida Real e Crime</title>
  <style>
    body {
      background-color: #111;
      color: white;
      font-family: sans-serif;
      margin: 0;
      overflow: hidden;
    }
    #game {
      position: relative;
      width: 900px;
      height: 600px;
      margin: 0 auto;
      background-color: #222;
      border: 3px solid lime;
    }
    .player, .building, .laser, .cofre, .car {
      position: absolute;
      border-radius: 5px;
    }
    .player {
      width: 30px;
      height: 30px;
      background: blue;
      transition: left 0.1s, top 0.1s;
      z-index: 10;
    }
    .bank {
      width: 120px;
      height: 100px;
      background: gold;
      top: 100px;
      left: 700px;
      text-align: center;
      line-height: 100px;
      font-weight: bold;
      user-select: none;
      cursor: default;
    }
    .laser {
      width: 5px;
      height: 100px;
      background: red;
      top: 100px;
      left: 740px;
      animation: piscar 0.6s infinite;
      border-radius: 3px;
    }
    .cofre {
      width: 40px;
      height: 40px;
      background: #444;
      top: 130px;
      left: 770px;
      border-radius: 3px;
    }
    .workplace {
      width: 150px;
      height: 50px;
      background: teal;
      top: 500px;
      left: 50px;
      text-align: center;
      line-height: 50px;
      font-weight: bold;
      cursor: pointer;
      user-select: none;
      border-radius: 8px;
      margin-bottom: 5px;
    }
    .house {
      width: 100px;
      height: 70px;
      background: brown;
      top: 350px;
      left: 600px;
      text-align: center;
      line-height: 70px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 8px;
      user-select: none;
    }
    .car {
      width: 50px;
      height: 30px;
      background: silver;
      top: 520px;
      left: 700px;
      cursor: pointer;
      text-align: center;
      line-height: 30px;
      font-weight: bold;
      color: black;
      user-select: none;
      border: 2px solid white;
    }
    #info {
      width: 900px;
      margin: 10px auto;
      text-align: center;
      font-size: 18px;
    }
    @keyframes piscar {
      0%, 50% { opacity: 1; }
      50.1%, 100% { opacity: 0; }
    }
  </style>
</head>
<body>
  <h1 style="text-align:center">üåÜ Cidade de Fortini - RPG Simula√ß√£o</h1>
  <div id="game">
    <div class="player" id="player"></div>

    <div class="bank">Banco</div>
    <div class="laser" id="laser"></div>
    <div class="cofre" id="cofre"></div>

    <!-- Trabalhos -->
    <div class="workplace" id="work1" style="top:500px; left:50px;">Trabalho: Entregador</div>
    <div class="workplace" id="work2" style="top:560px; left:50px;">Trabalho: Gar√ßom</div>

    <!-- Casas -->
    <div class="house" id="house1" style="top:350px; left:600px;">Casa 1 (R$ 1000)</div>
    <div class="house" id="house2" style="top:350px; left:720px;">Casa 2 (R$ 2000)</div>

    <!-- Carros -->
    <div class="car" id="car1" style="top:520px; left:700px;">Carro 1 (R$ 1500)</div>
    <div class="car" id="car2" style="top:520px; left:770px;">Carro 2 (R$ 3000)</div>
  </div>

  <div id="info">
    <p>Dinheiro: R$ <span id="dinheiro">0</span></p>
    <p>Status: <span id="status">Livre</span></p>
    <p>Posse: <span id="posse">Nenhum</span></p>
  </div>

  <script>
    const player = document.getElementById("player");
    const laser = document.getElementById("laser");
    const cofre = document.getElementById("cofre");
    const dinheiroSpan = document.getElementById("dinheiro");
    const statusSpan = document.getElementById("status");
    const posseSpan = document.getElementById("posse");

    let x = 10, y = 10;
    let speed = 5;
    let preso = false;
    let dinheiro = 0;
    let posse = {
      casa: null,
      carro: null,
    };
    let roubando = false;
    let puni√ß√£oTrabalho = false; // se j√° foi preso, sal√°rio menor

    // Trabalhos info
    const trabalhos = {
      work1: { nome: "Entregador", ganho: 300 },
      work2: { nome: "Gar√ßom", ganho: 250 },
    };

    // Casas info
    const casas = {
      house1: { preco: 1000, dono: null },
      house2: { preco: 2000, dono: null },
    };

    // Carros info
    const carros = {
      car1: { preco: 1500, dono: null, velocidade: 10 },
      car2: { preco: 3000, dono: null, velocidade: 15 },
    };

    // Fun√ß√£o para mover o jogador
    function mover(dx, dy) {
      if(preso) return; // preso n√£o anda
      x += dx * speed;
      y += dy * speed;
      x = Math.min(Math.max(0, x), 870);
      y = Math.min(Math.max(0, y), 570);
      player.style.left = x + "px";
      player.style.top = y + "px";
      verificarInteracoes();
    }

    // Verifica intera√ß√µes do jogador
    function verificarInteracoes() {
      const px = player.getBoundingClientRect();
      const laserBox = laser.getBoundingClientRect();
      const cofreBox = cofre.getBoundingClientRect();

      // Colis√£o com laser (se vis√≠vel)
      if (
        laser.offsetParent !== null &&
        laser.style.opacity !== "0" &&
        px.left < laserBox.right &&
        px.right > laserBox.left &&
        px.top < laserBox.bottom &&
        px.bottom > laserBox.top
      ) {
        alert("üö® Detectado pelo laser! Pol√≠cia chegando...");
        prenderJogador();
        return;
      }

      // Roubar cofre
      if (
        px.left < cofreBox.right &&
        px.right > cofreBox.left &&
        px.top < cofreBox.bottom &&
        px.bottom > cofreBox.top &&
        !roubando
      ) {
        roubando = true;
        alert("üí∞ Tentando roubar o cofre...");
        setTimeout(() => {
          if (Math.random() < 0.5) {
            alert("üöì Pegou no ato! Preso 10s.");
            prenderJogador();
          } else {
            alert("üí∏ Roubo bem-sucedido! +R$ 500.");
            dinheiro += 500;
            atualizarDinheiro();
            roubando = false;
          }
        }, 3000);
      }
    }

    // Prender jogador
    function prenderJogador() {
      preso = true;
      statusSpan.textContent = "Preso";
      player.style.background = "gray";
      document.removeEventListener("keydown", controlar);
      setTimeout(() => {
        preso = false;
        statusSpan.textContent = "Livre";
        alert("Voc√™ foi solto. Agora trabalhos pagam menos.");
        puni√ß√£oTrabalho = true;
        player.style.background = "blue";
        document.addEventListener("keydown", controlar);
      }, 10000);
    }

    // Trabalhar honestamente
    function trabalhar(id) {
      if (preso) {
        alert("Voc√™ est√° preso, n√£o pode trabalhar!");
        return;
      }
      let ganho = trabalhos[id].ganho;
      if (puni√ß√£oTrabalho) ganho = Math.floor(ganho / 2);
      dinheiro += ganho;
      atualizarDinheiro();
      alert(`Voc√™ trabalhou como ${trabalhos[id].nome} e ganhou R$ ${ganho}.`);
    }

    // Comprar casa
    function comprarCasa(id) {
      if (preso) {
        alert("Preso n√£o pode comprar casas!");
        return;
      }
      if (casas[id].dono !== null) {
        alert("Casa j√° comprada!");
        return;
      }
      if (dinheiro < casas[id].preco) {
        alert("Dinheiro insuficiente para comprar esta casa.");
        return;
      }
      dinheiro -= casas[id].preco;
      casas[id].dono = "Voc√™";
      posse.casa = id;
      atualizarDinheiro();
      atualizarPosse();
      alert("Casa comprada com sucesso!");
    }

    // Comprar carro
    function comprarCarro(id) {
      if (preso) {
        alert("Preso n√£o pode comprar carros!");
        return;
      }
      if (carros[id].dono !== null) {
        alert("Carro j√° comprado!");
        return;
      }
      if (dinheiro < carros[id].preco) {
        alert("Dinheiro insuficiente para comprar este carro.");
        return;
      }
      dinheiro -= carros[id].preco;
      carros[id].dono = "Voc√™";
      posse.carro = id;
      speed = carros[id].velocidade;
      atualizarDinheiro();
      atualizarPosse();
      alert("Carro comprado! Agora voc√™ anda mais r√°pido.");
    }

    // Atualiza dinheiro no HTML
    function atualizarDinheiro() {
      dinheiroSpan.textContent = dinheiro;
    }

    // Atualiza posse no HTML
    function atualizarPosse() {
      let text = "";
      if (posse.casa) text += "Casa: " + posse.casa + " ";
      if (posse.carro) text += "Carro: " + posse.carro;
      if (text === "") text = "Nenhum";
      posseSpan.textContent = text;
    }

    // Controlar jogador via teclado
    function controlar(e) {
      switch (e.key) {
        case "ArrowUp": mover(0, -1); break;
        case "ArrowDown": mover(0, 1); break;
        case "ArrowLeft": mover(-1, 0); break;
        case "ArrowRight": mover(1, 0); break;
      }
    }

    // Eventos para trabalhar
    document.getElementById("work1").addEventListener("click", () => trabalhar("work1"));
    document.getElementById("work2").addEventListener("click", () => trabalhar("work2"));

    // Eventos para comprar casas
    document.getElementById("house1").addEventListener("click", () => comprarCasa("house1"));
    document.getElementById("house2").addEventListener("click", () => comprarCasa("house2"));

    // Eventos para comprar carros
    document.getElementById("car1").addEventListener("click", () => comprarCarro("car1"));
    document.getElementById("car2").addEventListener("click", () => comprarCarro("car2"));

    // Inicializa jogador no centro
    player.style.left = x + "px";
    player.style.top = y + "px";

    // Ativa controle
    document.addEventListener("keydown", controlar);
  </script>
</body>
</html>
